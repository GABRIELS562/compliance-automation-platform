FROM python:3.9-slim

WORKDIR /app

# Install only necessary dependencies (no elasticsearch)
RUN pip install --no-cache-dir \
    flask \
    prometheus-client \
    docker \
    pyyaml \
    pandas \
    python-dateutil \
    requests \
    sqlalchemy \
    psycopg2-binary \
    cryptography

# Copy scripts
COPY ../scripts /app/scripts

# Create evidence directories
RUN mkdir -p /evidence /audit /data

EXPOSE 8888 8889 9999

CMD ["python", "/app/scripts/forensic_collector.py"]
